(this["webpackJsonplive-search-tmdb"]=this["webpackJsonplive-search-tmdb"]||[]).push([[0],{39:function(e,t,c){},40:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c.n(n),s=c(24),r=c.n(s),i=c(3),o=c(5),l=c(2),u=c(6),j=c.n(u),d=c(11),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,c=Object(n.useState)(e),a=Object(i.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){var c=setTimeout((function(){r(e)}),t);return function(){return clearTimeout(c)}})),s},h=Object(n.createContext)(),p=c(16),O=c(25),m=c(26),v=c(12),f=c(18),x=Object(f.a)("apiKey"),g=Object(f.a)("moviesUrl"),y=Object(f.a)("movieUrl"),N=function(){function e(){Object(O.a)(this,e),Object.defineProperty(this,x,{writable:!0,value:"6f14bb0ba1b5ca6a0116cfaafb3edd27"}),Object.defineProperty(this,g,{writable:!0,value:"https://api.themoviedb.org/3/search/movie"}),Object.defineProperty(this,y,{writable:!0,value:"https://api.themoviedb.org/3/movie/"})}return Object(m.a)(e,[{key:"constructUrl",value:function(e){return"".concat(e,"?api_key=").concat(Object(v.a)(this,x)[x],"&language=en-US&")}},{key:"getMovies",value:function(){var e=Object(d.a)(j.a.mark((function e(t){var c,n,a,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=s.length>1&&void 0!==s[1]?s[1]:1,n="".concat(Object(v.a)(this,g)[g],"?api_key=").concat(Object(v.a)(this,x)[x],"&query=").concat(t,"&page=").concat(c,"&language=en-US&"),e.next=4,fetch(n);case 4:return a=e.sent,e.next=7,a.json();case 7:return a=e.sent,e.abrupt("return",{page:a.page,movies:a.results});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMovie",value:function(){var e=Object(d.a)(j.a.mark((function e(t){var c,n,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat(Object(v.a)(this,y)[y]).concat(t,"?api_key=").concat(Object(v.a)(this,x)[x],"&language=en-US&"),n="".concat(Object(v.a)(this,y)[y]).concat(t,"/credits?api_key=").concat(Object(v.a)(this,x)[x],"&language=en-US&"),e.next=4,fetch(c);case 4:return a=e.sent,e.next=7,a.json();case 7:return a=e.sent,e.next=10,fetch(n);case 10:return s=e.sent,e.next=13,s.json();case 13:return s=e.sent,e.abrupt("return",this.composeMovie(a,s));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"composeMovie",value:function(e,t){var c=e.id,n=e.genres,a=e.original_title,s=e.budget,r=e.production_companies,i=e.release_date,o=e.runtime,l=e.overview,u=e.poster_path,j=t.cast,d=t.crew,b=d.sort((function(e,t){return e.popularity-t.popularity})).reverse().slice(0,20),h=function(e){var t=[],c=[];return e.forEach((function(e){e.profile?t.push(e):c.push(e)})),[].concat(t,c)},O=b.find((function(e){return"director"===e.job.toLowerCase()}));O||(O=b.find((function(e){return"directing"===e.known_for_department.toLowerCase()})));return{id:c,genres:n,title:a,runtime:o,date:i,budget:s,overview:l,directing:{id:!!O&&O.id,name:!!O&&O.name},poster:u,production:r.length?r[0].name:null,people:{cast:j.length?h(function(e){return e.slice(0,15).map((function(e){return{id:e.id,name:e.name,character:e.character,profile:e.profile_path,gender:1===e.gender?"female":"male"}}))}(j)):null,crew:d.length?h(function(e){var t=[],c=[];return e.forEach((function(n,a){if(!e[a+1])return null;if(n.name===e[a+1].name)return t.push(n.job),null;if(n.name!==e[a+1].name){t.push(n.job);var s={id:n.id,name:n.name,jobs:Object(p.a)(t),profile:n.profile_path};t=[],c.push(s)}})),c}(b)):null}}}}]),e}(),S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";localStorage.queryHistory||(localStorage.queryHistory=JSON.stringify([]));var c=JSON.parse(localStorage.queryHistory).slice(0,7);if(e){var n=c.findIndex((function(t){return t.title===e}));return c=-1!==n?[c[n]].concat(Object(p.a)(c.slice(0,n)),Object(p.a)(c.slice(n+1))):[{title:e,id:t}].concat(c),localStorage.queryHistory=JSON.stringify(c),{type:"SET_QUERY_HISTORY",payload:c}}return{type:"SET_QUERY_HISTORY",payload:c}},w=c(0),_=function(){return Object(w.jsx)("div",{className:"nothing-found",children:Object(w.jsx)("h2",{children:"Nothing found"})})},E=function(){return Object(w.jsx)("div",{className:"spinner",children:Object(w.jsx)("div",{className:"loadingio-spinner-spinner-7fyeb8xf3j",children:Object(w.jsxs)("div",{className:"ldio-qwie34wu23",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{})]})})})},k=function(e){var t=e.movies,c=e.dispatch,a=Object(n.useState)(),s=Object(i.a)(a,2),r=s[0],l=s[1];Object(n.useEffect)((function(){l(u(t))}),[t]);var u=function(e){return e.slice(0,7).map((function(e,t){return Object(w.jsx)("li",{className:"results-item","data-id":e.id,"data-title":e.title,children:Object(w.jsxs)(o.b,{to:"/movie/".concat(e.id),className:"results-item-link",children:[Object(w.jsx)("div",{className:"img-wrap",children:e.poster_path?Object(w.jsx)("img",{src:"https://image.tmdb.org/t/p/w500/".concat(e.poster_path),alt:""}):null}),Object(w.jsxs)("div",{className:"info",children:[Object(w.jsx)("p",{children:e.title}),Object(w.jsx)("span",{children:e.release_date})]})]})},t)}))};return Object(w.jsx)("ul",{className:"search-results-list",onClick:function(e){var t=e.target.closest(".results-item").dataset.id,n=e.target.closest(".results-item").dataset.title;c(S(n,t))},children:r})},T=function(e){var t=e.dispatch,c=Object(n.useContext)(h).state.queryHistory,a=Object(n.useState)(null),s=Object(i.a)(a,2),r=s[0],l=s[1];Object(n.useEffect)((function(){l(u(c))}),[c]);var u=function(e){return e.map((function(e){var t=e.id?"/movie/".concat(e.id):"/movies?query=".concat(e.title);return Object(w.jsx)("li",{className:"history-item","data-id":e.id,"data-title":e.title,children:Object(w.jsxs)(o.b,{to:t,children:[Object(w.jsx)("i",{className:"fas fa-history"}),Object(w.jsx)("p",{children:e.title})]})},"".concat(e.id).concat(e.title))}))};return Object(w.jsx)("ul",{className:"search-query-history",onClick:function(e){var c=e.target.closest(".history-item").dataset.id,n=e.target.closest(".history-item").dataset.title;t(S(n,c))},children:r})},R=function(e){var t=e.loading,c=e.inputValue,a=Object(n.useContext)(h),s=a.state.searchResults,r=a.dispatch;return Object(w.jsx)("div",{className:"search-dropdown",children:c?t?Object(w.jsx)(E,{}):s.length?Object(w.jsx)(k,{movies:s,dispatch:r}):Object(w.jsx)(_,{}):Object(w.jsx)(T,{dispatch:r})})},L=function(){var e=new N,t=Object(n.useContext)(h).dispatch,c=Object(n.useState)(""),a=Object(i.a)(c,2),s=a[0],r=a[1],o=Object(n.useState)(!1),u=Object(i.a)(o,2),p=u[0],O=u[1],m=Object(n.useState)(!1),v=Object(i.a)(m,2),f=v[0],x=v[1],g=Object(n.useRef)(null),y=b(s),_=Object(l.f)(),E=function(e){g.current&&!g.current.contains(e.target)&&O(!1)};return Object(n.useEffect)((function(){function c(){return(c=Object(d.a)(j.a.mark((function c(){var n;return j.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!y){c.next=9;break}return x(!0),c.next=4,e.getMovies(y);case 4:n=c.sent,t({type:"SET_SEARCH_RESULTS",payload:n}),x(!1),c.next=10;break;case 9:t({type:"SET_SEARCH_RESULTS",payload:{movies:[]}});case 10:case"end":return c.stop()}}),c)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[y]),Object(w.jsxs)("div",{className:p?"search-panel show-results":"search-panel",children:[Object(w.jsxs)("form",{action:"",className:"search-panel-field",onSubmit:function(e){e.preventDefault(),s&&(t({type:"SET_SEARCH_RESULTS",payload:{movies:[]}}),_.push("/movies?query=".concat(s)),t(S(s)),r(""),g.current.blur())},children:[Object(w.jsx)("input",{type:"text",className:"search-panel-input",ref:g,value:s,onChange:function(e){r(e.target.value),x(!0)},onFocus:function(){O(!0),document.addEventListener("click",E)},onBlur:function(){document.removeEventListener("click",E)}}),Object(w.jsx)("button",{className:"btn",type:"submit",children:"search"})]}),p&&Object(w.jsx)(R,{loading:f,inputValue:s})]})},C=c(9),M=function(e){var t=e.id,c=e.genres,n=e.title,a=e.runtime,s=e.budget,r=e.overview,i=e.poster,l=e.production,u=e.date,j=e.directing,d="".concat(Math.floor(a/60),"h ").concat(a-60*Math.floor(a/60),"m");return Object(w.jsxs)("div",{className:"movie",id:t,children:[Object(w.jsx)("div",{className:"movie-poster-wrap",children:i?Object(w.jsx)("img",{src:"https://image.tmdb.org/t/p/w500/".concat(i),alt:""}):null}),Object(w.jsxs)("div",{className:"movie-describe",children:[Object(w.jsx)("h2",{className:"title",children:n}),Object(w.jsxs)("div",{className:"under-title",children:[Object(w.jsx)("span",{className:"studio",children:l}),Object(w.jsxs)("span",{className:"date",children:["Release: ",u||"unknown"]})]}),Object(w.jsx)("p",{className:"overview",children:r}),Object(w.jsxs)("div",{className:"movie-ditails",children:[Object(w.jsxs)("h4",{"data-directing-id":j.id,children:[Object(w.jsx)("span",{children:"directing:"})," ",j.name||"unknown"]}),Object(w.jsxs)("h4",{children:[Object(w.jsx)("span",{children:"runtime:"})," ",d]}),Object(w.jsxs)("h4",{children:[Object(w.jsx)("span",{children:"budgete:"})," ",s," $"]}),Object(w.jsx)("ul",{className:"genres",children:c.map((function(e,t){var n=c[t+1]?"".concat(e.name,","):e.name;return Object(w.jsx)(o.b,{to:"#",children:n},t)}))})]})]})]})},U=function(e){var t=e.people,c=Object(n.useState)("cast"),a=Object(i.a)(c,2),s=a[0],r=a[1],l=Object(n.useState)(null),u=Object(i.a)(l,2),j=u[0],d=u[1];Object(n.useEffect)((function(){var e=b(t[s]);d(e)}),[s]);var b=function(e){return e&&e.map((function(e){var t=null;return t="cast"===s?Object(w.jsx)("span",{className:"character",children:e.character}):Object(w.jsxs)("ul",{className:"job-list",children:[" ",e.jobs.map((function(e){return Object(w.jsx)("li",{className:"job",children:e},e)}))]}),Object(w.jsxs)("li",{className:"cast-item",children:[Object(w.jsx)("div",{className:"img-wrap",children:e.profile?Object(w.jsx)("img",{src:"https://image.tmdb.org/t/p/w500/".concat(e.profile),alt:""}):null}),Object(w.jsxs)("div",{className:"person-info",children:[Object(w.jsx)(o.b,{to:"#",children:Object(w.jsx)("h3",{className:"name",children:e.name})}),t]})]},e.id)}))};return Object(w.jsxs)("div",{className:"movie-people",children:[Object(w.jsxs)("div",{className:"movie-people-header",children:[Object(w.jsx)("h2",{className:"movie-people-title",children:s}),Object(w.jsxs)("div",{className:"switch switch-".concat(s),onClick:function(e){e.target.classList.contains("cast")&&r("cast"),e.target.classList.contains("crew")&&r("crew")},children:[Object(w.jsx)("span",{className:"cast",children:"cast"}),Object(w.jsx)("span",{className:"crew",children:"crew"})]})]}),Object(w.jsx)("ul",{className:"cast-list",children:j})]})},H=function(e){var t=e.movie;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(M,Object(C.a)({},t)),Object(w.jsx)(U,{people:t.people})]})},q=function(){var e=new N,t=Object(l.h)().id,c=Object(n.useContext)(h),a=c.state.movie,s=c.dispatch,r=Object(n.useState)(!1),o=Object(i.a)(r,2),u=o[0],b=o[1];return Object(n.useEffect)((function(){(function(){var c=Object(d.a)(j.a.mark((function c(){var n;return j.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return b(!0),c.next=3,e.getMovie(t);case 3:n=c.sent,s({type:"SET_MOVIE",payload:n}),b(!1);case 6:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}})()()}),[t]),Object(w.jsx)("div",{className:"movie-info",children:u?Object(w.jsx)(E,{}):Object.keys(a).length?Object(w.jsx)(H,{movie:a}):null})},I=function(){var e=new N,t=Object(n.useContext)(h),c=t.state.moviesList,a=t.dispatch,s=Object(n.useState)(!1),r=Object(i.a)(s,2),u=r[0],b=r[1],p=new URLSearchParams(Object(l.g)().search).get("query");Object(n.useEffect)((function(){(function(){var t=Object(d.a)(j.a.mark((function t(){var c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.next=3,e.getMovies(p);case 3:c=t.sent,a({type:"SET_MOVIES_LIST",payload:c}),b(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[p]);var O=Object(n.useMemo)((function(){return function(e){return e.map((function(e,t){return Object(w.jsxs)("li",{className:"movies-list-item",children:[Object(w.jsx)("div",{className:"img-wrapper",children:e.poster_path?Object(w.jsx)("img",{src:"https://image.tmdb.org/t/p/w500/".concat(e.poster_path),alt:""}):null}),Object(w.jsxs)("div",{className:"info",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{className:"title",children:e.title}),Object(w.jsx)("span",{className:"date",children:e.release_date}),Object(w.jsx)("p",{className:"about",children:e.overview})]}),Object(w.jsx)(o.b,{to:"/movie/".concat(e.id),className:"btn-more",children:"more"})]})]},t)}))}(c)}),[c]);return Object(w.jsx)("ul",{className:"movies-list",children:u?Object(w.jsx)(E,{}):O.length?O:Object(w.jsx)(_,{})})},V=function(){return Object(w.jsxs)("div",{className:"home",children:[Object(w.jsx)("i",{className:"far fa-chevron-up"}),Object(w.jsx)("div",{className:"home__text",children:"Type to search movie"})]})},Y={searchResults:[],moviesList:[],queryHistory:[],loading:!0,movie:{}},A=function(e,t){switch(t.type){case"SET_SEARCH_RESULTS":return Object(C.a)(Object(C.a)({},e),{},{searchResults:t.payload.movies});case"SET_MOVIES_LIST":return Object(C.a)(Object(C.a)({},e),{},{loading:!1,page:t.payload.page,moviesList:t.payload.movies.slice(0,10)});case"SET_MOVIE":return Object(C.a)(Object(C.a)({},e),{},{loading:!1,movie:t.payload});case"SET_QUERY_HISTORY":return Object(C.a)(Object(C.a)({},e),{},{queryHistory:t.payload});case"SET_LOADING":return Object(C.a)(Object(C.a)({},e),{},{loading:!0});default:return e}},J=(c(39),function(){var e=Object(n.useReducer)(A,Y),t=Object(i.a)(e,2),c=t[0],a=t[1];return Object(n.useEffect)((function(){a(S())}),[]),Object(w.jsx)(o.a,{children:Object(w.jsx)("div",{className:"wrapper",children:Object(w.jsxs)(h.Provider,{value:{state:c,dispatch:a},children:[Object(w.jsx)(L,{}),Object(w.jsxs)(l.c,{children:[Object(w.jsx)(l.a,{path:"/movie/:id",component:q}),Object(w.jsx)(l.a,{path:"/movies",component:I}),Object(w.jsx)(l.a,{path:"/",component:V})]})]})})})});r.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(J,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.5f06d439.chunk.js.map